{"level":"info","time":"2025-08-09T20:40:41Z","message":"System has 7GB RAM, setting iceberg writer batch size to 104857600 bytes"}
{"level":"info","time":"2025-08-09T20:40:41Z","message":"Running sync with state: null"}
{"level":"info","message":"Standard Replication is selected","time":"2025-08-09T20:40:41Z"}
{"level":"info","time":"2025-08-09T20:40:41Z","message":"Starting discover for Postgres database source"}
{"level":"info","time":"2025-08-09T20:40:41Z","message":"Valid selected streams are public.orders"}
{"level":"warn","time":"2025-08-09T20:40:41Z","message":"aws_region not explicitly provided, will attempt to use region from environment variables or AWS config/credentials file"}
{"level":"info","message":"AWS credentials not explicitly provided, will use default credential chain (environment variables, AWS config/credentials file, or instance metadata service)","time":"2025-08-09T20:40:41Z"}
{"level":"info","time":"2025-08-09T20:40:42Z","message":"Iceberg JAR file found in base directory: /home/olake-iceberg-java-writer.jar"}
{"level":"info","time":"2025-08-09T20:40:42Z","message":"thread id 1: Connected to new iceberg writer on port 50051 for stream check_01K2890WMZXZV46WNM22CNN64X, configHash check_01K2890WMZXZV46WNM22CNN64X-check-false"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:43.207 [main] INFO  io.debezium.server.iceberg.OlakeRpcServer - Logs will be output to console only","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:43.572 [main] INFO  org.apache.iceberg.CatalogUtil - Loading custom FileIO implementation: org.apache.iceberg.aws.s3.S3FileIO","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:43.630 [main] INFO  io.debezium.serde.json.JsonSerdeConfig - JsonSerdeConfig values: ","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tfrom.field = null","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tunknown.properties.ignored = false","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] ","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:43.631 [main] INFO  io.debezium.serde.json.JsonSerdeConfig - JsonSerdeConfig values: ","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tfrom.field = null","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tunknown.properties.ignored = false","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] ","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:43.844 [main] INFO  io.debezium.server.iceberg.OlakeRpcServer - Server started on port 50051 with max message size: 1024MB","time":"2025-08-09T20:40:43Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:45.291 [grpc-default-executor-0] INFO  io.debezium.server.iceberg.rpc.OlakeRowsIngester - [Thread-24-14864034216988] Parsing messages took: 18 ms","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:45.338 [grpc-default-executor-0] WARN  io.debezium.server.iceberg.IcebergUtil - Creating table:'olake_iceberg.olake_test_table'","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] schema:table {","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051]   1: _olake_id: required string (id)","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051]   2: _op_type: optional string","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051]   3: _db: optional string","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051]   4: _olake_timestamp: optional timestamptz","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] }","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] rowIdentifier:[_olake_id]","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:45.472 [grpc-default-executor-0] WARN  io.debezium.server.iceberg.IcebergUtil - Created namespace:'olake_iceberg'","time":"2025-08-09T20:40:45Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:46.289 [grpc-default-executor-0] INFO  io.debezium.server.iceberg.tableoperator.IcebergTableOperator - Batch got 1 records with 1 different schema!!","time":"2025-08-09T20:40:46Z"}
{"level":"info","message":"[Java-Iceberg:50051] 20:40:46.298 [grpc-default-executor-0] INFO  io.debezium.server.iceberg.tableoperator.IcebergTableOperator - Creating new writer for thread: 1","time":"2025-08-09T20:40:46Z"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] 20:40:47.206 [grpc-default-executor-0] ERROR io.debezium.server.iceberg.rpc.OlakeRowsIngester - [Thread-24-14864034216988] Failed to process table events for table: olake_test_table"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] software.amazon.awssdk.core.exception.SdkClientException: Unable to load region from any of the providers in the chain software.amazon.awssdk.regions.providers.DefaultAwsRegionProviderChain@18f139d2: [software.amazon.awssdk.regions.providers.SystemSettingsRegionProvider@13653801: Unable to load region from system settings. Region must be specified either via environment variable (AWS_REGION) or  system property (aws.region)., software.amazon.awssdk.regions.providers.AwsProfileRegionProvider@43828d0: No region provided in profile: default, software.amazon.awssdk.regions.providers.InstanceProfileRegionProvider@5ac24659: Unable to contact EC2 metadata service.]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.core.exception.SdkClientException$BuilderImpl.build(SdkClientException.java:111) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.regions.providers.AwsRegionProviderChain.getRegion(AwsRegionProviderChain.java:70) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.awscore.client.builder.AwsDefaultClientBuilder.resolveRegion(AwsDefaultClientBuilder.java:372) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$DerivedValue.primeCache(AttributeMap.java:604) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$DerivedValue.get(AttributeMap.java:593) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.resolveValue(AttributeMap.java:400) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.internalGet(AttributeMap.java:389) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.access$1300(AttributeMap.java:201) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder$1.get(AttributeMap.java:403) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.services.s3.DefaultS3BaseClientBuilder.lambda$finalizeServiceConfiguration$2(DefaultS3BaseClientBuilder.java:197) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$DerivedValue.primeCache(AttributeMap.java:604) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$DerivedValue.get(AttributeMap.java:593) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.resolveValue(AttributeMap.java:400) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.internalComputeIfAbsent(AttributeMap.java:331) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.utils.AttributeMap$Builder.putLazyIfAbsent(AttributeMap.java:275) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.core.client.config.SdkClientConfiguration$Builder.lazyOptionIfAbsent(SdkClientConfiguration.java:182) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.awscore.client.builder.AwsDefaultClientBuilder.finalizeAwsConfiguration(AwsDefaultClientBuilder.java:190) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.awscore.client.builder.AwsDefaultClientBuilder.finalizeChildConfiguration(AwsDefaultClientBuilder.java:172) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.core.client.builder.SdkDefaultClientBuilder.syncClientConfiguration(SdkDefaultClientBuilder.java:208) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.services.s3.DefaultS3ClientBuilder.buildClient(DefaultS3ClientBuilder.java:37) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.services.s3.DefaultS3ClientBuilder.buildClient(DefaultS3ClientBuilder.java:26) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat software.amazon.awssdk.core.client.builder.SdkDefaultClientBuilder.build(SdkDefaultClientBuilder.java:175) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.aws.AwsClientFactories$DefaultAwsClientFactory.s3(AwsClientFactories.java:118) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.aws.s3.S3FileIO.client(S3FileIO.java:339) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.aws.s3.S3FileIO.newOutputFile(S3FileIO.java:141) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.io.OutputFileFactory.newOutputFile(OutputFileFactory.java:107) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.io.BaseTaskWriter$BaseRollingWriter.openCurrent(BaseTaskWriter.java:328) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.io.BaseTaskWriter$BaseRollingWriter.<init>(BaseTaskWriter.java:295) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.io.BaseTaskWriter$RollingFileWriter.<init>(BaseTaskWriter.java:377) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.io.UnpartitionedWriter.<init>(UnpartitionedWriter.java:37) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableWriterFactory.appendWriter(IcebergTableWriterFactory.java:66) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableWriterFactory.create(IcebergTableWriterFactory.java:47) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.addToTablePerSchema(IcebergTableOperator.java:297) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.addToTable(IcebergTableOperator.java:207) ~[olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.OlakeRowsIngester.sendRecords(OlakeRowsIngester.java:114) [olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.RecordIngestServiceGrpc$MethodHandlers.invoke(RecordIngestServiceGrpc.java:232) [olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182) [olake-iceberg-java-writer.jar:?]"}
{"level":"info","time":"2025-08-09T20:40:47Z","message":"thread id 1: shutting down Iceberg server on port 50051"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:356) [olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861) [olake-iceberg-java-writer.jar:?]"}
{"level":"error","time":"2025-08-09T20:40:47Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [olake-iceberg-java-writer.jar:?]"}
{"level":"fatal","time":"2025-08-09T20:40:47Z","message":"failed to test destination: error sending record to Iceberg RPC Server: rpc error: code = Internal desc = [Thread-24-14864034216988] Failed to process request: Unable to load region from any of the providers in the chain software.amazon.awssdk.regions.providers.DefaultAwsRegionProviderChain@18f139d2: [software.amazon.awssdk.regions.providers.SystemSettingsRegionProvider@13653801: Unable to load region from system settings. Region must be specified either via environment variable (AWS_REGION) or  system property (aws.region)., software.amazon.awssdk.regions.providers.AwsProfileRegionProvider@43828d0: No region provided in profile: default, software.amazon.awssdk.regions.providers.InstanceProfileRegionProvider@5ac24659: Unable to contact EC2 metadata service.]"}
